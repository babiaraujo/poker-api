<!DOCTYPE html>
<html>
<head>
  <title>WebSocket Test</title>
  <script src="https://cdn.jsdelivr.net/npm/@rails/actioncable@7.1.0-2.0.1/dist/actioncable.umd.js"></script>
  <script>
    // Expondo ActionCable no escopo global (caso o UMD não faça isso automaticamente)
    window.ActionCable = window.ActionCable || actioncable;
  </script>
</head>
<body>
  <h1>WebSocket conectado?</h1>
  <div id="status">🔄 Tentando conectar...</div>

  <script>
    const cable = ActionCable.createConsumer("ws://localhost:3000/cable");

    const subscription = cable.subscriptions.create(
      { channel: "RoomChannel", room_id: 1 },
      {
        connected() {
          document.getElementById("status").innerText = "✅ Conectado!";
          console.log("✅ Conectado ao canal!");
        },
        disconnected() {
          document.getElementById("status").innerText = "❌ Desconectado!";
          console.log("❌ Desconectado do canal.");
        },
        received(data) {
          console.log("📨 Mensagem recebida:", data);
        }
      }
    );
  </script>
</body>
</html>
